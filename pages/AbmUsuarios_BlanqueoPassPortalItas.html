<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/DiseñoGeneral.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="icon" type="image/png" href="../images/Favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Orbitron:wght@400..900&display=swap" rel="stylesheet">
    <title>Blanquear Password - Portal ITAS</title>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar position-relative">
        <div class="container-fluid d-flex justify-content-between align-items-center navbar-container">
            <a class="navbar-brand nvbar d-flex align-items-center" href="../pages/Front_APPs.html">
                <img src="../images/teco.png" alt="Logo" width="70" height="22">
                <span class="ms-2">PORTAL ITAS</span>
            </a>
            <span class="navbar-text nvbar navbar-center">Blanquear Contraseña - ABM Usuarios</span>
            <button class="nvbar" onclick="history.back()" style="background:none;border:1px solid white;color:white;padding:4px 10px;border-radius:4px;">
                Volver
            </button>
        </div>
    </nav>

    <!-- Contenido -->
    <div class="container mt-5">
        <div class="row mb-4">
            <div class="col-md-12">
                <h5 class="mb-3">Búsqueda de Usuario</h5>
                
                <!-- Buscador -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Buscar usuario por nombre, legajo o email:</label>
                        <input type="text" class="form-control" id="inputBuscar" placeholder="Ingrese nombre, legajo o email...">
                    </div>
                </div>

                <!-- Tabla de usuarios -->
                <div class="tabla-usuarios border rounded">
                    <table class="table table-sm table-hover mb-0">
                        <thead class="table-light sticky-top">
                            <tr>
                                <th style="width: 10%;">Legajo</th>
                                <th style="width: 30%;">Nombre Completo</th>
                                <th style="width: 40%;">Email</th>
                                <th style="width: 20%;">Estado</th>
                            </tr>
                        </thead>
                        <tbody id="tablaUsuarios">
                            <tr>
                                <td colspan="4" class="text-center text-muted">Cargando usuarios...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Información del usuario seleccionado -->
        <div id="infoUsuario" class="info-usuario">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Nombre:</strong> <span id="nombreSeleccionado">-</span></p>
                    <p><strong>Email:</strong> <span id="emailSeleccionado">-</span></p>
                </div>
                <div class="col-md-6">
                    <p><strong>Legajo:</strong> <span id="legajoSeleccionado">-</span></p>
                    <p><strong>Estado:</strong> <span id="estadoSeleccionado">-</span></p>
                </div>
            </div>
        </div>

        <!-- Botón de blanqueo -->
        <div class="row mb-4">
            <div class="col-md-12">
                <button id="btnBlanquear" class="btn btn-warning btn-lg w-100" disabled>
                    <i class="bi bi-exclamation-circle"></i> Blanquear Contraseña
                </button>
                <small class="d-block mt-2 text-muted">Seleccione un usuario de la tabla para habilitar el blanqueo.</small>
            </div>
        </div>

        <!-- Div para mensajes -->
        <div id="mensajeDiv" class="alert d-none mt-3" role="alert"></div>
    </div>

    <!-- Modal de confirmación -->
    <div class="modal fade" id="confirmModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title">Confirmar Blanqueo de Contraseña</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>¿Desea blanquear la contraseña del usuario <strong id="usuarioConfirm">-</strong>?</p>
                    <p>La nueva contraseña será: <code>Itas2026</code></p>
                    <p class="text-muted small">El usuario deberá cambiar esta contraseña en su próximo inicio de sesión.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-warning" id="btnConfirmarBlanqueo" data-bs-dismiss="modal">Blanquear</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de éxito -->
    <div class="modal fade" id="successModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">✓ Éxito</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>La contraseña ha sido blanqueada exitosamente.</p>
                    <p><strong>Usuario:</strong> <span id="usuarioExito">-</span></p>
                    <p class="text-muted small">El usuario deberá cambiar su contraseña en el próximo inicio de sesión.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Aceptar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de error -->
    <div class="modal fade" id="errorModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">✗ Error</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p id="errorMensaje">-</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Aceptar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/config.js"></script>
    <script src="../js/BlanqueoPasswordItas.js"></script>
</body>
</html>